-- Создание последовательностей для user & roles

CREATE SEQUENCE public.role_id_sequence
    INCREMENT 50
    START 10
    MINVALUE 1
    MAXVALUE 9223372036854775807
    CACHE 1;
ALTER SEQUENCE public.role_id_sequence
    OWNER TO postgres;

CREATE SEQUENCE public.user_id_sequence
    INCREMENT 50
    START 3
    MINVALUE 1
    MAXVALUE 9223372036854775807
    CACHE 1;
ALTER SEQUENCE public.user_id_sequence
    OWNER TO postgres;

-- Создание баз для hibernate
CREATE TABLE public.role
(
    id bigint NOT NULL,
    authority character varying(255) COLLATE pg_catalog."default",
    name character varying(255) COLLATE pg_catalog."default",
    CONSTRAINT role_pkey PRIMARY KEY (id),
    CONSTRAINT uk_irsamgnera6angm0prq1kemt2 UNIQUE (authority)
)
TABLESPACE pg_default;
ALTER TABLE public.role
    OWNER to postgres;

CREATE TABLE public.users
(
    id bigint NOT NULL,
    email character varying(255) COLLATE pg_catalog."default",
    password character varying(255) COLLATE pg_catalog."default",
    username character varying(255) COLLATE pg_catalog."default",
    CONSTRAINT users_pkey PRIMARY KEY (id),
    CONSTRAINT uk_r43af9ap4edm43mmtq01oddj6 UNIQUE (username)
)
TABLESPACE pg_default;
ALTER TABLE public.users
    OWNER to postgres;

CREATE TABLE public.role_assignments
(
    user_id bigint NOT NULL,
    role_id bigint NOT NULL,
    CONSTRAINT role_assignments_pkey PRIMARY KEY (user_id, role_id),
    CONSTRAINT fk2eeiikoxqyynyjt69v3ddrtf FOREIGN KEY (role_id)
        REFERENCES public.role (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fknxb2o14i5k3bnks0uty2fhgd FOREIGN KEY (user_id)
        REFERENCES public.users (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)
TABLESPACE pg_default;
ALTER TABLE public.role_assignments
    OWNER to postgres;

CREATE TABLE public.watering_parameters
(
    id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    "interval" bigint,
    name character varying(255) COLLATE pg_catalog."default",
    volume bigint,
    CONSTRAINT watering_parameters_pkey PRIMARY KEY (id)
)
TABLESPACE pg_default;
ALTER TABLE public.watering_parameters
    OWNER to postgres;

CREATE TABLE public.grow_programs
(
    id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    co2_id bigint,
    description character varying(255) COLLATE pg_catalog."default",
    light_id bigint,
    name character varying(255) COLLATE pg_catalog."default",
    temperature_id bigint,
    user_creator_id bigint,
    watering_parameters_id bigint,
    CONSTRAINT grow_programs_pkey PRIMARY KEY (id),
    CONSTRAINT fkb9b0iov2krkd3gsw16mpw8vy2 FOREIGN KEY (user_creator_id)
        REFERENCES public.users (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fkelkxem6csoh19exyjfxujddk3 FOREIGN KEY (watering_parameters_id)
        REFERENCES public.watering_parameters (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)
TABLESPACE pg_default;
ALTER TABLE public.grow_programs
    OWNER to postgres;

CREATE TABLE public.greenboxes
(
    id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    name character varying(255) COLLATE pg_catalog."default",
    grow_program_id bigint,
    user_id bigint,
    CONSTRAINT greenboxes_pkey PRIMARY KEY (id),
    CONSTRAINT fkkpvlxg4vllt849tf421g5pr58 FOREIGN KEY (user_id)
        REFERENCES public.users (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fkm6x61i0pdsjfx9frktyoxpw2e FOREIGN KEY (grow_program_id)
        REFERENCES public.grow_programs (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)
TABLESPACE pg_default;
ALTER TABLE public.greenboxes
    OWNER to postgres;

-- Создание Баз для хранения массивов
CREATE SEQUENCE public.co2_values_id_seq
    INCREMENT 1
    START 1
    MINVALUE 1
    MAXVALUE 9223372036854775807
    CACHE 1;

ALTER SEQUENCE public.co2_values_id_seq
    OWNER TO postgres;

CREATE TABLE if not exists public.co2_values
(
    id bigint NOT NULL DEFAULT nextval('co2_values_id_seq'::regclass),
    name character varying(255) COLLATE pg_catalog."default",
    arr double precision[],
    CONSTRAINT co2_values_pkey PRIMARY KEY (id)
)

TABLESPACE pg_default;

ALTER TABLE public.co2_values
    OWNER to postgres;

CREATE SEQUENCE public.light_values_id_seq
    INCREMENT 1
    START 1
    MINVALUE 1
    MAXVALUE 9223372036854775807
    CACHE 1;

ALTER SEQUENCE public.light_values_id_seq
    OWNER TO postgres;

CREATE TABLE if not exists public.light_values
(
    id bigint NOT NULL DEFAULT nextval('light_values_id_seq'::regclass),
    name character varying(255) COLLATE pg_catalog."default",
    arr double precision[],
    CONSTRAINT light_values_pkey PRIMARY KEY (id)
)

TABLESPACE pg_default;

ALTER TABLE public.light_values
    OWNER to postgres;

CREATE SEQUENCE public.temperatures_id_seq
    INCREMENT 1
    START 1
    MINVALUE 1
    MAXVALUE 9223372036854775807
    CACHE 1;

ALTER SEQUENCE public.temperatures_id_seq
    OWNER TO postgres;

CREATE TABLE if not exists public.temperature_values
(
    id bigint NOT NULL DEFAULT nextval('temperatures_id_seq'::regclass),
    name character varying(255) COLLATE pg_catalog."default",
    arr double precision[],
    CONSTRAINT temperatures_pkey PRIMARY KEY (id)
)

TABLESPACE pg_default;

ALTER TABLE public.temperature_values
    OWNER to postgres;

-- Загрузка данных в базы массивов, созданные мной
insert into temperature_values (name, arr) values 
('first temperature', '{18.1, 19.2, 21.0, 22.0, 23.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 23.0, 22.0, 24.0, 20.0, 19.0, 18.0, 18.0, 18.0, 18.0, 30.0}'),
('second temperature', '{22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5}');

insert into light_values (name, arr) values 
('first light', '{18.1, 19.0, 21.0, 22.0, 23.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 23.0, 22.0, 24.0, 20.0, 19.0, 18.0, 18.0, 18.0, 18.0, 18.0}'),
('second light', '{22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5}');

insert into co2_values (name, arr) values 
('first co2', '{18.1, 19.0, 21.0, 22.0, 23.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 23.0, 22.0, 24.0, 20.0, 19.0, 18.0, 18.0, 18.0, 18.0, 18.0}'),
('second co2', '{22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5}');

--Загрузка данных в базы, созданные Hibernate'ом
INSERT INTO role (ID, NAME , AUTHORITY) VALUES
(1, 'Users', 'ROLE_USER'),
(2, 'Administrators', 'ROLE_ADMIN');

INSERT INTO users (ID, USERNAME, PASSWORD) VALUES
(1, 'admin', '$2a$10$HWN.ZRVZzJsTrS1Dy2uuUeTu65DB/Qw6F6E7BFh0iCBBslZefqeZC'),
(2, 'test', '$2a$10$HWN.ZRVZzJsTrS1Dy2uuUeTu65DB/Qw6F6E7BFh0iCBBslZefqeZC'),
(3, 'test2', '$2a$10$HWN.ZRVZzJsTrS1Dy2uuUeTu65DB/Qw6F6E7BFh0iCBBslZefqeZC');

INSERT INTO ROLE_ASSIGNMENTS (USER_ID, ROLE_ID) VALUES
(1, 1),
(1, 2),
(2, 1),
(3, 1);

INSERT INTO watering_parameters (name, interval, volume) VALUES
('rain', 100, 1),
('waterfall', 1, 10),
('mars', 10000, 1);

INSERT INTO grow_programs (name, description, watering_parameters_id, temperature_id, light_id, co2_id, user_creator_id) VALUES 
('drown potatoes', 'its to much water', 2, 1, 2, 1, 1),
('drip irrigation', 'good choice', 1, 2, 1, 2, 1),
('wasteland', 'its a desert', 3, 2, 2, 2, 1);

INSERT INTO greenboxes (name , user_id, grow_program_id) VALUES
('first', 1, 1),
('second', 1, 2),
('test_first', 2, 1),
('test_second', 2, 3);